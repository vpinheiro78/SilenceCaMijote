<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Silence, ça mijote</title>
<link rel="stylesheet" href="style.css"/>
</head>
<body>
<header class="site-header">
  <h1>Silence, ça mijote</h1>
  <div id="langSelector" class="lang-selector">
    <img src="assets/flags/fr.svg" alt="FR" data-lang="fr">
    <img src="assets/flags/en.svg" alt="EN" data-lang="en">
    <img src="assets/flags/es.svg" alt="ES" data-lang="es">
    <img src="assets/flags/de.svg" alt="DE" data-lang="de">
    <img src="assets/flags/it.svg" alt="IT" data-lang="it">
    <img src="assets/flags/pt.svg" alt="PT" data-lang="pt">
  </div>
  <a class="admin-link" href="admin/login.html" title="Admin"><img src="assets/logo.png" alt="Logo" /></a>
</header>

<main class="container">
  <div class="blurb" id="site-blurb">Recettes préparées avec amour : des plats savoureux et gourmands pour régaler vos proches à chaque repas.</div>

  <div class="search-row">
    <input id="search" type="search" placeholder="Rechercher une recette, un ingrédient..." />
  </div>

  <div class="categories" id="categories">
    <button data-cat="all" class="cat-btn">Toutes</button>
    <button data-cat="dessert" class="cat-btn cat-dessert">Dessert</button>
    <button data-cat="viande" class="cat-btn cat-viande">Viande</button>
    <button data-cat="poisson" class="cat-btn cat-poisson">Poisson</button>
    <button data-cat="accompagnement" class="cat-btn cat-accompagnement">Accompagnement</button>
    <button data-cat="autre" class="cat-btn cat-autre">Autre</button>
  </div>
  
  <div class="newsletter">
    <form id="subscribeForm">
      <h3>Abonnez-vous pour être notifié dès qu’une nouvelle recette est publiée !</h3>
      <input type="email" name="email" placeholder="Votre email" required style="padding:10px; width:250px; border-radius:6px; border:1px solid #ccc"/>
      <button type="submit" class="btn-liste-courses">S'abonner</button>
    </form>
    <p id="subscribeMessage" style="margin-top:6px;color:green;"></p>
  </div>

  <section id="recipes" class="grid" aria-live="polite"></section>
</main>

<footer class="site-footer">© 2025 Silence, ça mijote</footer>

<script type="module" src="script.js"></script>

<script>
const availableLangs = ['fr','en','es','de','it','pt'];
const defaultLang = 'fr';

function changeLanguage(lang) {
  if (!availableLangs.includes(lang)) lang = defaultLang;
  localStorage.setItem('siteLang', lang);

  fetch(`translations/${lang}.json`)
    .then(res => res.json())
    .then(data => {
      document.getElementById('site-blurb').innerText = data.blurb.main;
      document.getElementById('search').placeholder = data.search.placeholder;

      document.querySelector('#subscribeForm h3').innerText = data.newsletter.title;
      document.querySelector('#subscribeForm input[name="email"]').setAttribute('placeholder', data.newsletter.email_placeholder);
      document.querySelector('#subscribeForm button').innerText = data.newsletter.subscribe_button;

      const categories = data.categories;
      document.querySelector('button[data-cat="all"]').innerText = categories.all;
      document.querySelector('button[data-cat="dessert"]').innerText = categories.dessert;
      document.querySelector('button[data-cat="viande"]').innerText = categories.viande;
      document.querySelector('button[data-cat="poisson"]').innerText = categories.poisson;
      document.querySelector('button[data-cat="accompagnement"]').innerText = categories.accompagnement;
      document.querySelector('button[data-cat="autre"]').innerText = categories.autre;
    });
}

// Appliquer la langue sauvegardée ou langue par défaut au chargement
const savedLang = localStorage.getItem('siteLang') || defaultLang;
changeLanguage(savedLang);

// Ajouter les événements sur les drapeaux
document.querySelectorAll('#langSelector img').forEach(img => {
  img.addEventListener('click', () => changeLanguage(img.dataset.lang));
});
</script>

</body>
</html>
